<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body { background: #09090b; color: #fff; font-family: 'Inter', sans-serif; user-select: none; overflow: hidden; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #3f3f46; }

        /* SIDEBAR */
        .sidebar-item {
            padding: 10px 12px; margin-bottom: 4px; border-radius: 8px; cursor: pointer;
            display: flex; align-items: center; gap: 10px; font-size: 13px; color: #a1a1aa; transition: 0.2s;
        }
        .sidebar-item:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .sidebar-item.active { background: #2563eb; color: #fff; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }

        /* INPUTS */
        .input-box {
            width: 100%; background: #18181b; border: 1px solid #27272a; color: white;
            padding: 10px 12px; border-radius: 8px; font-size: 13px; outline: none; transition: 0.2s;
        }
        .input-box:focus { border-color: #3b82f6; background: #27272a; }

        /* BUTTONS */
        .btn-action {
            padding: 8px 16px; background: #fff; color: black; font-size: 12px; font-weight: 600;
            border-radius: 6px; cursor: pointer; transition: 0.2s; border: none; display: flex; align-items: center; justify-content: center; gap: 6px;
        }
        .btn-action:hover { background: #e4e4e7; transform: translateY(-1px); }
        .btn-action:active { transform: scale(0.96); }
        
        .btn-danger { background: rgba(239, 68, 68, 0.1); color: #ef4444; }
        .btn-danger:hover { background: rgba(239, 68, 68, 0.2); }

        /* ANIMATIONS */
        .tab-content { animation: fade-in 0.2s ease-out; }
        @keyframes fade-in { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex h-screen w-full">

    <div class="w-48 bg-[#09090b] border-r border-white/5 p-4 flex flex-col h-full flex-shrink-0">
        <div class="text-[10px] font-bold text-gray-500 mb-4 px-2 tracking-widest uppercase">System Control</div>
        
        <div class="sidebar-item active" onclick="switchTab('tab-general', this)">
            <i data-lucide="user" class="w-4 h-4"></i> Profile
        </div>
        <div class="sidebar-item" onclick="switchTab('tab-display', this)">
            <i data-lucide="monitor" class="w-4 h-4"></i> Display
        </div>
        <div class="sidebar-item" onclick="switchTab('tab-info', this)">
            <i data-lucide="cpu" class="w-4 h-4"></i> System
        </div>
    </div>

    <div class="flex-1 bg-[#0c0c0e] p-8 overflow-y-auto h-full relative">
        
        <div id="tab-general" class="tab-content">
            <h1 class="text-xl font-semibold mb-1">User Profile</h1>
            <p class="text-xs text-gray-500 mb-8">Manage your identity and session data.</p>
            
            <div class="bg-white/5 p-5 rounded-xl border border-white/5 mb-6">
                <label class="text-xs text-gray-400 mb-2 block font-medium">Display Name</label>
                <div class="flex gap-3">
                    <input type="text" id="input-name" class="input-box" placeholder="Guest User">
                    <button class="btn-action" onclick="saveName(this)">
                        <i data-lucide="save" class="w-3 h-3"></i> Save
                    </button>
                </div>
            </div>

            <div class="bg-red-500/5 p-5 rounded-xl border border-red-500/10">
                <label class="text-xs text-red-400 mb-2 block font-medium">Danger Zone</label>
                <button class="btn-action btn-danger w-full justify-start" onclick="resetSystem()">
                    <i data-lucide="trash-2" class="w-3 h-3"></i> Factory Reset System
                </button>
                <p class="text-[10px] text-gray-600 mt-2">This will wipe all local data and reload the kernel.</p>
            </div>
        </div>

        <div id="tab-display" class="tab-content hidden">
            <h1 class="text-xl font-semibold mb-1">Display</h1>
            <p class="text-xs text-gray-500 mb-8">Customize your desktop environment.</p>
            
            <div class="bg-white/5 p-5 rounded-xl border border-white/5 mb-6">
                <label class="text-xs text-gray-400 mb-2 block font-medium">Custom Wallpaper URL</label>
                <div class="flex gap-3">
                    <input type="text" id="input-wall" class="input-box" placeholder="https://example.com/image.jpg">
                    <button class="btn-action" onclick="saveWallpaper(this)">Apply</button>
                </div>
            </div>

            <label class="text-xs text-gray-400 mb-3 block font-medium">Presets</label>
            <div class="grid grid-cols-2 gap-4">
                <div class="aspect-video bg-zinc-800 rounded-lg cursor-pointer hover:ring-2 ring-blue-500 overflow-hidden transition group" 
                     onclick="setPreset('https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?q=80&w=2574')">
                    <img src="https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?q=80&w=400" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                </div>
                <div class="aspect-video bg-zinc-800 rounded-lg cursor-pointer hover:ring-2 ring-blue-500 overflow-hidden transition group" 
                     onclick="setPreset('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2672')">
                    <img src="https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=400" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                </div>
                <div class="aspect-video bg-zinc-800 rounded-lg cursor-pointer hover:ring-2 ring-blue-500 overflow-hidden transition group" 
                     onclick="setPreset('https://images.unsplash.com/photo-1477346611705-65d1883cee1e?q=80&w=2670')">
                    <img src="https://images.unsplash.com/photo-1477346611705-65d1883cee1e?q=80&w=400" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                </div>
                <div class="aspect-video bg-zinc-800 rounded-lg cursor-pointer hover:ring-2 ring-blue-500 overflow-hidden transition group" 
                     onclick="setPreset('https://images.unsplash.com/photo-1614850523459-c2f4c699c52e?q=80&w=2670')">
                    <img src="https://images.unsplash.com/photo-1614850523459-c2f4c699c52e?q=80&w=400" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                </div>
            </div>
        </div>

        <div id="tab-info" class="tab-content hidden">
            <h1 class="text-xl font-semibold mb-1">System Info</h1>
            <p class="text-xs text-gray-500 mb-8">Hardware and software diagnostics.</p>
            
            <div class="bg-white/5 rounded-xl border border-white/5 overflow-hidden">
                <div class="p-4 flex justify-between items-center border-b border-white/5">
                    <span class="text-sm text-gray-300">OS Version</span>
                    <span class="text-xs font-mono text-blue-400 bg-blue-400/10 px-2 py-1 rounded">5.3 ENT</span>
                </div>
                <div class="p-4 flex justify-between items-center border-b border-white/5">
                    <span class="text-sm text-gray-300">Resolution</span>
                    <span class="text-xs font-mono text-gray-400" id="sys-res">1920x1080</span>
                </div>
                <div class="p-4 flex justify-between items-center border-b border-white/5">
                    <span class="text-sm text-gray-300">Platform</span>
                    <span class="text-xs font-mono text-gray-400" id="sys-plat">WebAssembly</span>
                </div>
                <div class="p-4 flex justify-between items-center border-b border-white/5">
                    <span class="text-sm text-gray-300">Power Status</span>
                    <span class="text-xs font-mono text-green-400" id="sys-bat">AC Power</span>
                </div>
                <div class="p-4 flex justify-between items-center">
                    <span class="text-sm text-gray-300">Network</span>
                    <span class="text-xs font-mono text-green-400 flex items-center gap-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div> Online
                    </span>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- BOOT ---
        window.onload = () => {
            lucide.createIcons();
            loadSavedData();
            loadSystemStats();
        };

        // --- NAVIGATION ---
        function switchTab(id, btn) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Remove active state
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
            
            // Show target
            document.getElementById(id).classList.remove('hidden');
            btn.classList.add('active');
        }

        // --- DATA LOGIC ---
        function loadSavedData() {
            const savedName = localStorage.getItem('vertex_user');
            if(savedName) document.getElementById('input-name').value = savedName;
        }

        function saveName(btn) {
            const name = document.getElementById('input-name').value;
            if(name) {
                localStorage.setItem('vertex_user', name);
                notifyOS('user_updated');
                animateBtn(btn);
            }
        }

        function saveWallpaper(btn) {
            const url = document.getElementById('input-wall').value;
            if(url) {
                localStorage.setItem('vertex_wall', url);
                notifyOS('wall_updated');
                animateBtn(btn);
            }
        }

        function setPreset(url) {
            localStorage.setItem('vertex_wall', url);
            notifyOS('wall_updated');
        }

        function resetSystem() {
            if(confirm("Are you sure? This will wipe your settings.")) {
                localStorage.clear();
                notifyOS('reset');
            }
        }

        // --- IPC COMMUNICATION ---
        function notifyOS(msg) {
            window.parent.postMessage(msg, '*');
        }

        function animateBtn(btn) {
            const originalHTML = btn.innerHTML;
            btn.innerHTML = `<i data-lucide="check" class="w-3 h-3"></i> Saved`;
            btn.classList.add('bg-green-500', 'text-white', 'border-transparent');
            btn.classList.remove('bg-white', 'text-black');
            lucide.createIcons();

            setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.classList.remove('bg-green-500', 'text-white', 'border-transparent');
                btn.classList.add('bg-white', 'text-black');
                lucide.createIcons();
            }, 1500);
        }

        // --- SYSTEM STATS (Safe Mode) ---
        async function loadSystemStats() {
            document.getElementById('sys-res').innerText = `${window.screen.width}x${window.screen.height}`;
            document.getElementById('sys-plat').innerText = navigator.platform;

            // Safe Battery Check
            try {
                if ('getBattery' in navigator) {
                    const bat = await navigator.getBattery();
                    const updateBat = () => {
                        const level = Math.round(bat.level * 100);
                        const status = bat.charging ? "Charging" : "Battery";
                        document.getElementById('sys-bat').innerText = `${level}% ${status}`;
                        document.getElementById('sys-bat').className = bat.charging ? "text-xs font-mono text-green-400" : "text-xs font-mono text-yellow-400";
                    };
                    updateBat();
                    bat.addEventListener('levelchange', updateBat);
                    bat.addEventListener('chargingchange', updateBat);
                }
            } catch (e) {
                console.log("Battery API not supported.");
            }
        }
    </script>
</body>
</html>
